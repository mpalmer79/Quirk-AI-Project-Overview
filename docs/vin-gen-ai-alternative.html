<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VIN Gen AI Alternative</title>

  <!-- Force LIGHT theme -->
  <meta name="color-scheme" content="light" />

  <!-- Keep all relative URLs under this GitHub Pages project -->
  <base href="/Quirk-AI-Project-Overview/">

  <!-- Sitewide styles (topbar, fonts, watermark rules, etc.) -->
  <link rel="stylesheet" href="assets/style.css" />
<link rel="stylesheet" href="assets/css/vin-alt.css" />

</head>
<body class="page">
  <div class="home-wrap">
    <a class="home-btn" href="https://mpalmer79.github.io/Quirk-AI-Project-Overview/">HOME</a>
  </div>

  <!-- ======= Top Navigation Bar ======= -->
  <header class="topbar" role="banner">
    <div class="topbar-inner">
      <a class="home-link" href="./">HOME</a>
      <div class="topbar-title">VIN Gen AI Alternative</div>
      <nav class="topbar-menu" aria-label="Secondary Navigation">
        <a class="topbar-title-link" href="project-library.html">Project Library</a>
      </nav>
    </div>
  </header>

  <!-- ======= Page Content ======= -->
  <main class="page-wrap" id="top">
    <section class="hero">
      <h1>VIN Gen&nbsp;AI Alternative ‚Äî Appointment-First Automation</h1>
      <p class="muted">Designed for BDC teams to respond faster, book more shows, and keep every touch logged in VIN Solutions.</p>
    </section>

    <!-- >>>>>> Agent Playground <<<<<< -->
    <section id="playground" class="section">
      <div class="pillbar" aria-hidden="true">
        <span class="pill">Agent Playground</span>
        <span class="pill sub">Draft ‚Üí Approve ‚Üí Send</span>
      </div>
      <h2 class="sr-only">Agent Playground (Draft ‚Üí Approve ‚Üí Send)</h2>
      <p class="muted">Paste a lead, pick a model/trim, and generate a ready-to-send draft that always drives to two appointment options.</p>

      <details>
        <summary>Open for more (what this does)</summary>
        <div class="small" style="margin-top:8px">
          <ul>
            <li>Builds an email/SMS with [[stock_count]], [[model_trim]], [[cash_rebate]], [[apr_rate]], [[two_appt_options]], and lease tokens when available.</li>
            <li>Today: uses front-end logic; later, switch <code>API_BASE</code> to your AutoGPT Platform URL or Worker.</li>
          </ul>
        </div>
      </details>

      <div class="cards" style="margin-top:12px">
        <div class="card">
          <h3>Lead Context</h3>
          <label class="small" for="leadText">Paste lead snippet (name, interest, zip, notes)</label>
          <textarea id="leadText" rows="6" style="width:100%;border:1px solid #e2e8f0;border-radius:10px;padding:10px"></textarea>

          <div style="display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));margin-top:10px">
            <div>
              <label class="small" for="make">Make</label>
              <input id="make" class="small" style="width:100%;border:1px solid #e2e8f0;border-radius:8px;padding:8px" value="Chevrolet" />
            </div>
            <div>
              <label class="small" for="model">Model</label>
              <input id="model" class="small" style="width:100%;border:1px solid #e2e8f0;border-radius:8px;padding:8px" value="Traverse" />
            </div>
            <div>
              <label class="small" for="zip">ZIP (inventory)</label>
              <input id="zip" class="small" style="width:100%;border:1px solid #e2e8f0;border-radius:8px;padding:8px" value="03103" />
            </div>
            <div>
              <label class="small" for="offersZip">ZIP (offers override)</label>
              <input id="offersZip" class="small" style="width:100%;border:1px solid #e2e8f0;border-radius:8px;padding:8px" value="03103" />
            </div>
            <div>
              <label class="small" for="channel">Channel</label>
              <select id="channel" class="small" style="width:100%;border:1px solid #e2e8f0;border-radius:8px;padding:8px">
                <option value="email">Email</option>
                <option value="sms">SMS</option>
              </select>
            </div>
          </div>

          <!-- Agent Profiles -->
          <div style="margin-top:10px">
            <label class="small">Agent Profile</label><br>
            <div id="profilesSeg" class="seg" role="tablist" aria-label="Agent Profiles">
              <button class="active" data-profile="new_lead" role="tab" aria-selected="true">New Lead</button>
              <button data-profile="best_price" role="tab" aria-selected="false">Best Price</button>
              <button data-profile="credit" role="tab" aria-selected="false">Credit-Challenged</button>
              <button data-profile="manager" role="tab" aria-selected="false">Manager Tone</button>
            </div>
            <div class="small muted" id="profileHelp" style="margin-top:6px">Preset shapes tone + CTA; ‚ÄúBest Price‚Äù also nudges pricing scenario.</div>
          </div>

          <button id="composeBtn" class="btn" style="margin-top:12px">Generate Draft</button>
        </div>

        <div class="card">
          <h3>Output</h3>
          <div id="draftPane" class="small" style="white-space:pre-wrap;min-height:140px;border:1px dashed #e2e8f0;border-radius:10px;padding:10px"></div>
          <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap">
            <button id="copyDraftBtn" class="btn small">Copy</button>
            <button id="saveRunBtn" class="btn small" title="Simulates logging a run like AutoGPT Platform">Save as Run</button>
          </div>

          <!-- Feedback bar -->
          <div id="feedbackBar" class="small" style="display:flex;gap:8px;margin-top:10px;align-items:center;flex-wrap:wrap">
            <span class="muted">Feedback:</span>
            <button id="fbUp" class="btn small" title="Helpful">üëç</button>
            <button id="fbDown" class="btn small" title="Needs work">üëé</button>
            <input id="fbReason" class="small" placeholder="optional note (what was great / missing)" style="flex:1;border:1px solid #e2e8f0;border-radius:8px;padding:8px;min-width:220px">
            <button id="fbSave" class="btn small" title="Save feedback">Save</button>
            <span id="fbSaved" class="small muted" style="display:none">Saved ‚úì</span>
          </div>

          <details style="margin-top:10px">
            <summary>Open for more (cURL for backend wiring)</summary>
<pre class="small" id="curlBlock" style="overflow:auto"></pre>
          </details>
        </div>
      </div>
    </section>
    <!-- >>>>>> END Agent Playground <<<<<< -->

    <!-- >>>>>> Batch Composer (Queue ‚Üí Generate ‚Üí Export) <<<<<< -->
    <section id="batch" class="section">
      <div class="pillbar" aria-hidden="true">
        <span class="pill">Batch Composer</span>
        <span class="pill sub">Queue ‚Üí Generate ‚Üí Export</span>
      </div>
      <h2 class="sr-only">Batch Composer</h2>
      <p class="muted">Paste multiple leads (one per line or blank-line separated). Uses the same Make/Model/ZIP/Offers ZIP and current <strong>Agent Profile</strong> from the Playground.</p>

      <div class="cards" style="margin-top:12px">
        <div class="card">
          <h3>Lead List</h3>
          <label class="small" for="batchInput">Examples: <em>‚ÄúName: Maria, asks about rebates‚Äù</em> or raw lead snippets. Blank lines create new items.</label>
          <textarea id="batchInput" rows="8" style="width:100%;border:1px solid #e2e8f0;border-radius:10px;padding:10px"></textarea>

          <div class="small muted" style="margin-top:8px" id="batchCount">0 leads detected</div>
          <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap">
            <button id="batchParseBtn" class="btn small">Parse</button>
            <button id="batchGenerateBtn" class="btn small">Generate All</button>
            <button id="batchExportBtn" class="btn small" title="Export drafts to CSV">Export CSV</button>
            <button id="batchClearBtn" class="btn small" title="Clear results">Clear</button>
          </div>
        </div>

        <div class="card">
          <h3>Results</h3>
          <div id="batchStatus" class="small muted">No results yet.</div>
          <div id="batchTableWrap" class="small" style="margin-top:8px;overflow:auto"></div>
        </div>
      </div>
    </section>
    <!-- >>>>>> END Batch Composer <<<<<< -->

    <!-- Executive Summary -->
    <section id="executive-summary" class="section">
      <h2>Executive Summary</h2>
      <p class="muted">VIN Solutions remains your CRM backbone. The Gen&nbsp;AI layer personalizes emails/SMS/call prompts in real time, injects inventory & incentives, and auto-logs tasks/appointments in VIN.</p>

      <div class="cards">
        <div class="card">
          <h3>Current Pain (VIN-only)</h3>
          <ul class="small">
            <li>Canned templates feel impersonal</li>
            <li>Heavy manual personalization & task follow-up</li>
            <li>Slow response on busy days</li>
            <li>Appointments depend on agent skill</li>
          </ul>
        </div>
        <div class="card">
          <h3>Gen AI Overlay</h3>
          <ul class="small">
            <li>&lt; 5-minute responses with inventory & incentives</li>
            <li>Tasks/appointments created & logged in VIN</li>
            <li>Consistent appointment push with 2 time options</li>
            <li>Projected +15‚Äì20% appointment conversion lift</li>
          </ul>
        </div>
      </div>

      <details class="section">
        <summary>Open for more (proof points & examples)</summary>
        <div class="callout small" style="margin-top:10px">
          <strong>Example</strong>: ‚ÄúWe have 3 Traverses in stock including RS; $1,500 customer cash + 2.9% APR. Can I reserve one for Thursday evening or Saturday morning?‚Äù
        </div>
      </details>
    </section>

    <!-- KPIs -->
    <section id="kpis" class="section">
      <h2>Target KPIs</h2>
      <div class="kpi-grid" style="display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));margin:12px 0 24px;">
        <div class="tile" style="border:1px solid #e2e8f0;border-radius:16px;padding:16px 14px;background:#fff;">
          <h3>Appointment Conversion</h3>
          <div class="num" style="font-size:1.6rem;font-weight:800;">+15‚Äì20%</div>
          <div class="muted small">within 6 months</div>
        </div>
        <div class="tile" style="border:1px solid #e2e8f0;border-radius:16px;padding:16px 14px;background:#fff;">
          <h3>Response Speed</h3>
          <div class="num" style="font-size:1.6rem;font-weight:800;">&lt; 5 min</div>
          <div class="muted small">avg compose+send</div>
        </div>
        <div class="tile" style="border:1px solid #e2e8f0;border-radius:16px;padding:16px 14px;background:#fff;">
          <h3>Staff Workload</h3>
          <div class="num" style="font-size:1.6rem;font-weight:800;">‚àí30%</div>
          <div class="muted small">manual tasks/emails</div>
        </div>
        <div class="tile" style="border:1px solid #e2e8f0;border-radius:16px;padding:16px 14px;background:#fff;">
          <h3>Follow-up Compliance</h3>
          <div class="num" style="font-size:1.6rem;font-weight:800;">95%+</div>
          <div class="muted small">VIN tasks on time</div>
        </div>
      </div>
    </section>

    <!-- Workflow Comparison -->
    <section id="workflow" class="section">
      <h2>Workflow Comparison</h2>
      <div class="cards">
        <div class="card">
          <h3>VIN Solutions (Today)</h3>
          <ol class="small">
            <li>New lead ‚Üí manual template pick</li>
            <li>Agent edits pricing/inventory</li>
            <li>Manual task & appt creation</li>
            <li>Follow-ups depend on agent</li>
          </ol>
        </div>
        <div class="card">
          <h3>Gen AI Alternative (Overlay)</h3>
          <ol class="small">
            <li>Lead hits VIN ‚Üí AI pulls inventory + incentives</li>
            <li>AI composes email/SMS w/ 2 appt slots (&lt;5 min)</li>
            <li>Auto-logs activity & creates VIN task/appointment</li>
            <li>AI re-nudges at 24/48h; manager escalates at 7d</li>
          </ol>
        </div>
      </div>

      <details class="section">
        <summary>Open for more (sample activity log fields)</summary>
        <div class="small" style="margin-top:8px">
          <ul>
            <li><code>activity_note(html)</code> with inventory & incentive tokens</li>
            <li><code>lead_id</code>, <code>suggested_times</code>, <code>task_due_at</code></li>
            <li><code>appointment(start/end)</code> on acceptance</li>
          </ul>
        </div>
      </details>
    </section>

    <!-- Smart Response Library -->
    <section id="library" class="section">
      <h2>Smart Response Library (Sampler)</h2>
      <p class="muted">Standardized email/SMS/call prompts that always push toward an appointment.</p>

      <div class="cards">
        <div class="card">
          <h3>New Internet Lead ‚Äî Inventory</h3>
          <p class="small"><strong>Email</strong>: ‚ÄúHi [Name], we currently have <em>[stock_count]</em> [Model] in stock including [trim]. This week: <em>[cash_rebate]</em> + <em>[apr_rate]</em>. Would Thursday 6:15pm or Saturday 10:30am work for a quick drive?‚Äù</p>
        </div>
        <div class="card">
          <h3>Best Price Inquiry</h3>
          <p class="small">‚ÄúThe [Model] is $[price] with incentives. I can have one ready for you ‚Äî does Thursday evening or Saturday morning work best?‚Äù</p>
        </div>
        <div class="card">
          <h3>‚ÄúI‚Äôm Just Shopping‚Äù</h3>
          <p class="small">‚ÄúTotally understand. How about a quick 15-minute no-obligation test drive? It‚Äôll help you compare. Thursday or Saturday?‚Äù</p>
        </div>
        <div class="card">
          <h3>No Response 24/48h</h3>
          <p class="small">Light nudge with inventory/incentive reminder and two new times. Auto-schedules in VIN.</p>
        </div>
      </div>

      <details class="section">
        <summary>Open for more (all 20 scenarios list)</summary>
        <div class="small" style="margin-top:8px">
          Includes: Trade-In Interest, Lease vs Purchase, Appointment Confirmation, Reschedule, Missed Appt Recovery, Post-Test-Drive, Manager Escalation, Final-Chance Closeout, Post-Sale Thank You, Unsold Visit Follow-Up, End-of-Month Push, Credit-Challenged, Out-of-Area, Vehicle On-Order, Vehicle Sold ‚Äî Alternatives, Service-to-Sales Equity Mining, and more.
        </div>
      </details>
    </section>

    <!-- Training & Roleplay -->
    <section id="training" class="section">
      <h2>Training & Roleplay</h2>
      <p class="muted">Run calls twice: first with a typical VIN template, then with AI prompts. Measure whether the appointment was secured.</p>

      <div class="cards">
        <div class="card">
          <h3>Traverse Example (Phone)</h3>
          <p class="small"><strong>AI prompt</strong>: mention stock count ‚Üí cite incentive ‚Üí offer two times. Consistent appointment push beats generic invites.</p>
        </div>
        <div class="card">
          <h3>Objection Handling</h3>
          <p class="small">Reassure ‚Üí low-commitment visit ‚Üí two time options. Keeps the conversation alive and directed to a show.</p>
        </div>
      </div>

      <details class="section">
        <summary>Open for more (quick drill checklist)</summary>
        <ul class="small" style="margin-top:8px">
          <li>Pair up (customer/agent)</li>
          <li>Run VIN style ‚Üí score outcome</li>
          <li>Run AI style ‚Üí score outcome</li>
          <li>Note confidence, clarity, and appointment set</li>
        </ul>
      </details>
    </section>

    <!-- Inventory & Incentives Integration -->
    <section id="inventory" class="section">
      <h2>Inventory & Incentives Integration</h2>
      <p class="muted">AI reads live website inventory and OEM programs, then injects tokens into responses while keeping work inside VIN.</p>

      <div class="cards">
        <div class="card">
          <h3>Data & Endpoints</h3>
          <ul class="small">
            <li><strong>Inventory</strong>: <code>GET /inventory.json</code> (stock_number, vin, year, trim, status, price, photo, updated_at)</li>
            <li><strong>Incentives</strong>: <code>GET /incentives?make=&amp;model=&amp;zip=</code> (cash_rebate, apr, term, expiry)</li>
            <li><strong>Tokens</strong>: [[stock_count]], [[model_trim]], [[cash_rebate]], [[apr_rate]], [[two_appt_options]], [[primary_photo]]</li>
          </ul>
        </div>
        <div class="card">
          <h3>Event Flow</h3>
          <ol class="small">
            <li>New lead arrives in VIN</li>
            <li>AI pulls inventory + incentives</li>
            <li>Composes email/SMS (&lt;5 min) with two slots</li>
            <li>Logs Activity + creates Task/Appt in VIN</li>
            <li>Handles replies; sends confirmation/reminder</li>
          </ol>
        </div>
      </div>

      <details class="section">
        <summary>Open for more (fallbacks & SLAs)</summary>
        <div class="small" style="margin-top:8px">
          If inventory feed unreachable ‚Üí serve cache ‚â§15 min & flag ‚Äústale‚Äù.  
          If incentives timeout ‚Üí omit incentives line, keep the appointment CTA.  
          Price/availability mismatch ‚Üí add ‚Äúsubject to prior sale‚Äù + closest alternative.
        </div>
      </details>
    </section>

    <!-- >>>>>> Live Tokens <<<<<< -->
    <section id="live-tokens" class="section">
      <h2>Live Tokens (Inventory & Incentives)</h2>
      <p class="muted">Pulls live feeds (or cache) to populate tokens the drafts will use.</p>

      <div class="cards">
        <div class="card">
          <h3>Token Preview</h3>
          <div class="small" id="tokenPreview">Awaiting selection‚Ä¶</div>
          <div class="small muted" id="tokenMeta" style="margin-top:6px"></div>
          <button id="refreshTokensBtn" class="btn small" style="margin-top:10px">Refresh Tokens</button>
        </div>
      </div>
    </section>
    <!-- >>>>>> END Live Tokens <<<<<< -->

    <!-- Desk Log Insights -->
    <section id="insights" class="section">
      <h2>Desk Log Insights (Snapshot)</h2>
      <p class="muted">Where automation helps most: faster first replies and auto-nudges when staff are busy.</p>

      <div class="cards">
        <div class="card">
          <h3>Funnel Summary</h3>
          <table class="table small" aria-label="Funnel summary">
            <thead><tr><th>Stage</th><th>Count</th><th>Conv from prior</th></tr></thead>
            <tbody>
              <tr><td>Leads Created</td><td>17</td><td>‚Äî</td></tr>
              <tr><td>Contacted</td><td>9</td><td>-47%</td></tr>
              <tr><td>Appointments Set</td><td>0</td><td>-100%</td></tr>
              <tr><td>Showroom Visits</td><td>0</td><td>‚Äî</td></tr>
              <tr><td>Deals</td><td>0</td><td>‚Äî</td></tr>
            </tbody>
          </table>
        </div>
        <div class="card">
          <h3>Response Time Buckets</h3>
          <table class="table small" aria-label="Response times">
            <thead><tr><th>Bucket</th><th>Count</th></tr></thead>
            <tbody>
              <tr><td>1‚Äì24 hrs</td><td>9</td></tr>
              <tr><td>No Attempt</td><td>8</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="callout small" style="margin-top:12px">
        <strong>Opportunity</strong>: Auto-compose within 5 minutes + 24/48-hour re-nudges + manager escalation at day 7 closes the gap from ‚Äúcontacted‚Äù to ‚Äúappointments set.‚Äù
      </div>
    </section>

    <!-- Implementation Timeline -->
    <section id="timeline" class="section">
      <h2>Implementation Timeline</h2>
      <div class="cards">
        <div class="card">
          <h3>Phase 1: Discovery/Design (M1-2)</h3>
          <ul class="small">
            <li>Map BDC workflows; pick top 20‚Äì30 scenarios</li>
            <li>Draft templates; assemble AI training set</li>
          </ul>
        </div>
        <div class="card">
          <h3>Phase 2: Build/Pilot (M3-4)</h3>
          <ul class="small">
            <li>Email automation + VIN integration</li>
            <li>Pilot with small BDC group; track KPIs</li>
          </ul>
        </div>
        <div class="card">
          <h3>Phase 3: Full Email Deploy (M5)</h3>
          <ul class="small">
            <li>Roll to full team; monitor response speed & conversions</li>
            <li>Scope real-time phone prompts</li>
          </ul>
        </div>
        <div class="card">
          <h3>Phase 4-5: Expansion (M6-12)</h3>
          <ul class="small">
            <li>Phone assist + live inventory feeds</li>
            <li>Scale to additional rooftops; continuous improvement</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- >>>>>> Recent Agent Runs <<<<<< -->
    <section id="runs" class="section">
      <h2>Recent Agent Runs</h2>
      <p class="muted">Drafts saved from the Playground appear here. Later, point this at the Platform backend.</p>
      <div class="cards">
        <div class="card">
          <h3>Last 10</h3>
          <div id="runsTable" class="small">No runs yet.</div>
          <button id="reloadRunsBtn" class="btn small" style="margin-top:10px">Reload</button>
        </div>
      </div>
    </section>
    <!-- >>>>>> END Recent Agent Runs <<<<<< -->

    <!-- Downloads -->
    <section id="downloads" class="section">
      <h2>Downloads</h2>
      <p class="muted">Save or print one-pagers, training packets, and response libraries.</p>

      <div class="cards">
        <div class="card">
          <h3>Executive Summary ‚Äî VIN vs Gen AI</h3>
          <p class="small">High-level comparison of current VIN workflow and the AI overlay.</p>
          <p><a class="btn" target="_blank" rel="noopener" href="assets/Executive_Summary_VIN_vs_GenAI.pdf">Open PDF</a></p>
        </div>

        <div class="card">
          <h3>Smart Response Library (Full ‚Äî 20 Scenarios)</h3>
          <p class="small">Ready-to-use email, SMS, and call prompts for the BDC.</p>
          <p><a class="btn" target="_blank" rel="noopener" href="assets/BDC_Smart_Response_Library_Full.pdf">Open PDF</a></p>
        </div>

        <div class="card">
          <h3>Training Packet (AI vs VIN)</h3>
          <p class="small">Roleplay scripts and drills to drive appointment-setting.</p>
          <p><a class="btn" target="_blank" rel="noopener" href="assets/BDC_Training_Packet_v2.pdf">Open PDF</a></p>
        </div>

        <div class="card">
          <h3>Inventory Integration ‚Äî One-Pager</h3>
          <p class="small">How live inventory & incentives flow into responses; VIN writebacks.</p>
          <p><a class="btn" target="_blank" rel="noopener" href="assets/GenAI_Inventory_Integration_OnePager_v3.pdf">Open PDF</a></p>
        </div>

        <div class="card">
          <h3>Project Plan</h3>
          <p class="small">Phases, milestones, success metrics, roles & responsibilities.</p>
          <p><a class="btn" target="_blank" rel="noopener" href="assets/BDC_Smart_Response_Project_Plan.pdf">Open PDF</a></p>
        </div>

        <div class="card">
          <h3>Desk Log Analysis (Snapshot)</h3>
          <p class="small">Funnel, response times, and lead source contact rates.</p>
          <p><a class="btn" target="_blank" rel="noopener" href="assets/desklog_analysis_summary.pdf">Open PDF</a></p>
        </div>

        <div class="card">
          <h3>Workflow Comparison (Slide or Image)</h3>
          <p class="small">Overview of VIN vs Gen AI process steps.</p>
          <p><a class="btn" target="_blank" rel="noopener" href="assets/VINS%20vs%20Gen%20AI%20Alternative%20summary.pdf">Open PDF</a></p>
        </div>

        <div class="card">
          <h3>Full Bundle (ZIP)</h3>
          <p class="small">All leadership-ready PDFs in one package.</p>
          <p><a class="btn" target="_blank" rel="noopener" href="assets/Quirk_AI_Project_PDFs.zip">Open ZIP</a></p>
        </div>

        <div class="card">
          <h3>FAQ</h3>
          <p class="small">Answers for managers and agents on rollout, KPIs, and workflow.</p>
          <p><a class="btn" target="_blank" rel="noopener" href="assets/Quirk_AI_VIN_GenAI_FAQ.pdf">Open PDF</a></p>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section id="faq" class="section">
      <h2>FAQ</h2>

      <details>
        <summary>Will AI replace our BDC agents?</summary>
        <div class="small" style="margin-top:8px">
          <p><strong>No.</strong> AI drafts, nudges, and keeps tasks moving; people build trust and close. The system removes repetitive work so agents can focus on live conversations and appointment-setting.</p>
          <p><strong>What AI handles</strong></p>
          <ul>
            <li>Composes personalized emails/SMS with inventory & incentives in under 5 minutes.</li>
            <li>Creates/updates VIN activities, tasks, and appointments so nothing slips.</li>
            <li>Sends 24/48-hour re-nudges and day-7 manager escalation, consistently.</li>
            <li>Provides real-time talk tracks for common objections.</li>
          </ul>
          <p><strong>What agents do</strong></p>
          <ul>
            <li>Approve/modify outbound messages as needed and make the calls.</li>
            <li>Handle pricing nuance, trade-value conversations, and relationship building.</li>
            <li>Confirm appointment details, coordinate vehicles, and close for the show.</li>
          </ul>
        </div>
      </details>

      <details>
        <summary>Does everything stay inside VIN Solutions?</summary>
        <div class="small" style="margin-top:8px">
          <p><strong>Yes‚ÄîVIN remains the system of record.</strong> The AI layer writes back every interaction so reporting and accountability live in one place.</p>
          <ul>
            <li><strong>Activities:</strong> full message body (HTML note), who/when, and tokens used.</li>
            <li><strong>Tasks:</strong> auto-created follow-ups with due dates to maintain compliance.</li>
            <li><strong>Appointments:</strong> proposed times and confirmed start/end once the customer accepts.</li>
          </ul>
        </div>
      </details>

      <details>
        <summary>How do incentives and inventory stay accurate?</summary>
        <div class="small" style="margin-top:8px">
          <p>Live data with sensible fallbacks: if feeds are missing, the message omits specifics and keeps the appointment CTA; cache ‚â§15 minutes if inventory is unreachable.</p>
        </div>
      </details>
    </section>

  </main>

  <!-- Footer -->
  <footer class="footer">
    <small>¬© 2025 Quirk AI ‚Äî VIN Gen AI Alternative</small>
  </footer>

  <!-- ====================== SCRIPTS ====================== -->

  <!-- Step 1: Agent Playground script + Agent Profiles + Feedback -->
  <script>
  /* -------- Agent Playground: front-end generator with backend-ready cURL -------- */
  const API_BASE = ""; // later: "https://your-platform.example.com" (FastAPI)
  const OEM_TTL_MS = 15 * 60 * 1000; // 15 minutes

  /* Agent Profile state */
  let __agentProfile = 'new_lead'; // 'new_lead' | 'best_price' | 'credit' | 'manager'

  /* Profiles: tone + CTA modifiers */
  const PROFILES = {
    new_lead: {
      opener: "Hi",
      closer: "‚Äî Quirk BDC",
      cta: (a,b)=>`Would ${a} or ${b} work for a quick drive? I can have one ready.`,
      disclaimer: (ch)=> ch==="email" ? "\n\nPricing/availability subject to prior sale. Incentives subject to eligibility; see dealer for details." : ""
    },
    best_price: {
      opener: "Hi",
      closer: "‚Äî Quirk Pricing Team",
      cta: (a,b)=>`I can show all programs side-by-side on a vehicle you can drive. Would ${a} or ${b} work for a quick visit?`,
      forceScenario: "best_price",
      disclaimer: (ch)=> ch==="email" ? "\n\nAll pricing subject to incentives/eligibility; see dealer for details." : ""
    },
    credit: {
      opener: "Hi",
      closer: "‚Äî Quirk BDC",
      cta: (a,b)=>`We work with many lenders‚Äîhappy to walk options with no obligation. Would ${a} or ${b} work to stop by for 15 minutes?`,
      disclaimer: (ch)=> ch==="email" ? "\n\nFinancing subject to credit approval; terms may vary." : ""
    },
    manager: {
      opener: "Hi",
      closer: "‚Äî Sales Manager, Quirk",
      cta: (a,b)=>`I'll personally set aside a vehicle for you. Would ${a} or ${b} work for a quick drive?`,
      disclaimer: (ch)=> ch==="email" ? "\n\nSubject to prior sale; incentives and availability change frequently." : ""
    }
  };

  /* Intent classifier expanded to catch "rebates/offers/APR/lease" */
  function classifyLeadText(lead) {
    const t = String(lead || "").toLowerCase();
    if (/(rebate|incentive|offer|program|apr|lease)/.test(t)) return "offers_question";
    if (/(trade|trade-in|appraisal|value|kbb|carvana|carmax)/.test(t)) return "trade_in";
    if (/(best price|price quote|out the door|otd|lowest|payment)/i.test(t)) return "best_price";
    if (/(just looking|just shopping|browsing|compare|research)/i.test(t)) return "just_shopping";
    if (/(available|in stock|inventory|color|trim|option)/i.test(t)) return "new_inventory";
    return "new_inventory";
  }

  function tonePreset(profileKey) {
    const p = PROFILES[profileKey] || PROFILES.new_lead;
    return p;
  }

  function buildMessage({ scenario, tokens, model, name, twoSlots, channel, meta, profileKey }) {
    const tone = tonePreset(profileKey);
    const greeting = `${tone.opener} ${name || "there"},`;

    const inventoryLine =
      `We currently have ${tokens.stock_count ?? "several"} ${model} in stock including ${tokens.model_trim ?? "popular trims"}.`;

    const incentivesBits = [];
    if (tokens.cash_rebate) incentivesBits.push(tokens.cash_rebate);
    if (tokens.apr_rate)    incentivesBits.push(tokens.apr_rate);
    const incentivesLine = incentivesBits.length ? `This week: ${incentivesBits.join(" + ")}.` : "";

    const offersAck = incentivesBits.length
      ? `Great question on current offers ‚Äî ${incentivesBits.join(" + ")} for well-qualified customers.`
      : `Great question on current offers ‚Äî I‚Äôll pull the exact programs for your ZIP and eligibility.`;

    const copyMap = {
      offers_question: `${offersAck} ${tone.cta(twoSlots[0], twoSlots[1])}`,
      new_inventory:   tone.cta(twoSlots[0], twoSlots[1]),
      best_price:      `I can show current programs side-by-side on a vehicle you can drive. ${tone.cta(twoSlots[0], twoSlots[1])}`,
      just_shopping:   `No pressure‚Äî15 minutes is enough to compare trims in person. ${tone.cta(twoSlots[0], twoSlots[1])}`,
      trade_in:        `Bring your keys and we‚Äôll give you a firm number in about 20 minutes. ${tone.cta(twoSlots[0], twoSlots[1])}`,
    };
    const copy = copyMap[scenario] || copyMap.new_inventory;

    const disclaimer = tone.disclaimer(channel);

    // Optional source link (email only)
    const srcLink = (channel === "email" && meta?.oem_source)
      ? `\nSource: GM Financial current offers ‚Äî ${meta.oem_source}`
      : "";

    if (channel === "sms") {
      return `${greeting} ${inventoryLine} ${incentivesLine} ${copy}`;
    }
    return `${greeting}\n\n${inventoryLine}${incentivesLine ? "\n" + incentivesLine : ""}\n\n${copy}\n\n${tone.closer}${disclaimer}${srcLink}`;
  }

  function extractName(lead) {
    const m = (lead || "").match(/name[:\-]?\s*([A-Z][a-z]+)\b/mi);
    return m ? m[1] : null;
  }

  // simple two-slot generator
  function generateTwoApptOptions() {
    if (window.__apptOptions?.suggest) return window.__apptOptions.suggest();
    const now = new Date();
    const thurs = nextDowAt(now, 4, 18, 15);
    const sat   = nextDowAt(now, 6, 10, 30);
    return [fmt(thurs), fmt(sat)];
  }
  function nextDowAt(base, dow, hh, mm) { const d = new Date(base); const diff = (dow - d.getDay() + 7) % 7 || 7; d.setDate(d.getDate() + diff); d.setHours(hh, mm, 0, 0); return d; }
  function fmt(d) { return d.toLocaleString(undefined, { weekday:"long", hour:"numeric", minute:"2-digit" }); }

  async function composeDraftFrontEnd({ lead, make, model, zip, offersZip, channel, profileKey }) {
    const full = await window.__inventoryTokens?.getFull({ make, model, zip, offersZip }).catch(() => null);
    const tokens = full?.tokens || {};
    const meta   = full?.meta   || {};
    const twoSlots = generateTwoApptOptions();

    // Scenario may be forced by the profile
    const classified = classifyLeadText(lead);
    const scenario = (PROFILES[profileKey]?.forceScenario) || classified;

    const name = extractName(lead);
    const text = buildMessage({ scenario, tokens, model, name, twoSlots, channel, meta, profileKey });

    return { text, tokens: { ...tokens, two_appt_options: twoSlots, scenario, profile: profileKey } };
  }

  /* Profiles UI wiring */
  (function wireProfiles(){
    const seg = document.getElementById('profilesSeg');
    if (!seg) return;
    seg.addEventListener('click', (e) => {
      const btn = e.target.closest('button[data-profile]');
      if (!btn) return;
      seg.querySelectorAll('button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      __agentProfile = btn.getAttribute('data-profile');
      document.getElementById('profileHelp').textContent = ({
        new_lead: 'Balanced tone. Book a quick drive with two options.',
        best_price: 'Price-forward tone. Nudges pricing scenario and side-by-side programs.',
        credit: 'Reassuring tone. Mentions many lenders; low-commitment visit.',
        manager: 'Authoritative tone. Manager signature and strong CTA.'
      })[__agentProfile] || 'Preset shapes tone + CTA.';
    });
  })();

  /* Feedback helpers */
  function saveFeedback({ rating }) {
    const reason = document.getElementById('fbReason')?.value || '';
    const draft = document.getElementById('draftPane')?.textContent || '';
    if (!draft) { alert('Generate a draft first.'); return; }
    const feedback = JSON.parse(localStorage.getItem('agent_feedback') || '[]');
    const entry = {
      id: 'fb_' + Date.now(),
      rating, // 'up' | 'down'
      reason,
      draft_preview: draft.slice(0, 240),
      profile: __agentProfile,
      channel: document.getElementById('channel')?.value || 'email',
      make: document.getElementById('make')?.value || '',
      model: document.getElementById('model')?.value || '',
      zip: document.getElementById('zip')?.value || '',
      offersZip: document.getElementById('offersZip')?.value || '',
      created_at: new Date().toISOString()
    };
    feedback.unshift(entry);
    localStorage.setItem('agent_feedback', JSON.stringify(feedback));
    const badge = document.getElementById('fbSaved');
    if (badge) { badge.style.display = 'inline'; setTimeout(()=> badge.style.display='none', 1400); }
    window.dispatchEvent(new Event('agent_feedback_updated'));
  }

  document.getElementById('fbUp')?.addEventListener('click', () => saveFeedback({ rating: 'up' }));
  document.getElementById('fbDown')?.addEventListener('click', () => saveFeedback({ rating: 'down' }));
  document.getElementById('fbSave')?.addEventListener('click', () => saveFeedback({ rating: 'note' }));

  /* Compose + actions */
  document.getElementById('composeBtn')?.addEventListener('click', async () => {
    const lead = document.getElementById('leadText').value.trim();
    const make = document.getElementById('make').value.trim();
    const model = document.getElementById('model').value.trim();
    const zip = document.getElementById('zip').value.trim();
    const offersZip = document.getElementById('offersZip').value.trim() || zip;
    const channel = document.getElementById('channel').value;
    const profileKey = __agentProfile;

    const { text, tokens } = await composeDraftFrontEnd({ lead, make, model, zip, offersZip, channel, profileKey });
    document.getElementById('draftPane').textContent = text;

    const payload = JSON.stringify({ lead, make, model, zip, offersZip, channel, profileKey, tokens }, null, 2);
    const curl = API_BASE
      ? `curl -X POST '${API_BASE}/api/compose' -H 'Content-Type: application/json' -d '${payload.replace(/\n/g,"")}'`
      : `# When your AutoGPT Platform is up, set API_BASE and use:\n# curl -X POST '$API_BASE/api/compose' -H 'Content-Type: application/json' -d '${payload.replace(/\n/g,"")}'`;
    document.getElementById('curlBlock').textContent = curl;
  });

  document.getElementById('copyDraftBtn')?.addEventListener('click', async () => {
    const text = document.getElementById('draftPane').textContent;
    if (!text) return;
    await navigator.clipboard.writeText(text);
    alert('Draft copied to clipboard.');
  });

  document.getElementById('saveRunBtn')?.addEventListener('click', () => {
    const draft = document.getElementById('draftPane').textContent;
    if (!draft) return;
    const runs = JSON.parse(localStorage.getItem('agent_runs') || '[]');
    const run = {
      id: 'run_' + Date.now(),
      status: 'drafted',
      created_at: new Date().toISOString(),
      channel: document.getElementById('channel').value,
      profile: __agentProfile,
      preview: draft.slice(0,180) + (draft.length>180?'‚Ä¶':'' )
    };
    runs.unshift(run);
    localStorage.setItem('agent_runs', JSON.stringify(runs));
    window.dispatchEvent(new Event('agent_runs_updated'));
  });
  </script>

  <!-- Step 1B: Batch Composer (queue -> compose -> export) -->
  <script>
  (function(){
    const $ = (id) => document.getElementById(id);
    const state = { items: [] }; // {id, raw, name, channelPref, channel, make, model, zip, offersZip, draft}

    function parseLeads(raw) {
      const chunks = String(raw || "").replace(/\r/g,'').split(/\n\s*\n/g).map(s=>s.trim()).filter(Boolean);
      const leads = (chunks.length > 1 ? chunks : String(raw || "").split(/\n/g).map(s=>s.trim()).filter(Boolean));
      return leads.map((raw, i) => {
        const nameMatch = raw.match(/name[:\-]?\s*([A-Z][a-z]+)/i);
        const channelMatch = raw.match(/\b(sms|text|email)\b/i);
        return {
          id: 'lead_' + (Date.now() + i),
          raw,
          name: nameMatch ? nameMatch[1] : null,
          channelPref: channelMatch ? channelMatch[1].toLowerCase() : null,
        };
      });
    }
    function refreshCount(){ $('batchCount').textContent = `${state.items.length} lead${state.items.length===1?'':'s'} detected`; }

    function renderTable() {
      if (!state.items.length) { $('batchStatus').textContent = 'No results yet.'; $('batchTableWrap').innerHTML=''; return; }
      $('batchStatus').textContent = 'Generated drafts appear below.';
      const rows = state.items.map((it, idx) => `
        <tr>
          <td>${idx+1}</td>
          <td>${(it.name || '‚Äî')}</td>
          <td>${(it.channel || it.channelPref || 'email')}</td>
          <td>${(it.zip || '‚Äî')}</td>
          <td>${(it.offersZip || '‚Äî')}</td>
          <td style="white-space:pre-wrap">${(it.draft || '‚Äî').replace(/</g,'&lt;')}</td>
          <td style="white-space:nowrap">
            <button class="btn small" data-id="${it.id}" data-act="copy">Copy</button>
            <button class="btn small" data-id="${it.id}" data-act="fbup" title="Helpful">üëç</button>
            <button class="btn small" data-id="${it.id}" data-act="fbdown" title="Needs work">üëé</button>
          </td>
        </tr>
      `).join('');
      $('batchTableWrap').innerHTML = `
        <table class="table">
          <thead><tr><th>#</th><th>Name</th><th>Channel</th><th>ZIP</th><th>Offers ZIP</th><th>Draft</th><th>Actions</th></tr></thead>
          <tbody>${rows}</tbody>
        </table>`;
    }

    function exportCSV() {
      if (!state.items.length) return alert('Nothing to export.');
      const headers = ['name','channel','zip','offers_zip','make','model','profile','draft'];
      const lines = [headers.join(',')];
      state.items.forEach(it => {
        const vals = [
          (it.name || ''),
          (it.channel || it.channelPref || 'email'),
          (it.zip || ''),
          (it.offersZip || ''),
          (it.make || ''),
          (it.model || ''),
          (__agentProfile || 'new_lead'),
          (it.draft || '').replace(/\n/g,' ').replace(/"/g,'""'),
        ].map(v => `"${v}"`);
        lines.push(vals.join(','));
      });
      const blob = new Blob([lines.join('\n')], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'batch_drafts.csv';
      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }

    async function generateAll() {
      if (!state.items.length) return alert('Paste and Parse first.');
      $('batchGenerateBtn').disabled = true; $('batchGenerateBtn').textContent = 'Generating‚Ä¶';

      const make = $('make')?.value.trim() || 'Chevrolet';
      const model = $('model')?.value.trim() || 'Traverse';
      const zip = $('zip')?.value.trim() || '03103';
      const offersZip = $('offersZip')?.value.trim() || zip;
      const profileKey = __agentProfile;

      for (const it of state.items) {
        const channel = it.channelPref || ($('channel')?.value || 'email');
        it.channel = channel; it.make = make; it.model = model; it.zip = zip; it.offersZip = offersZip;

        const { text } = await composeDraftFrontEnd({ lead: it.raw, make, model, zip, offersZip, channel, profileKey });
        it.draft = text;

        // Save as run
        const runs = JSON.parse(localStorage.getItem('agent_runs') || '[]');
        runs.unshift({
          id: 'run_' + Date.now() + '_' + Math.random().toString(36).slice(2,7),
          status: 'drafted',
          created_at: new Date().toISOString(),
          channel, profile: profileKey,
          preview: text.slice(0,180) + (text.length>180?'‚Ä¶':'')
        });
        localStorage.setItem('agent_runs', JSON.stringify(runs));
        window.dispatchEvent(new Event('agent_runs_updated'));

        renderTable();
      }

      $('batchGenerateBtn').disabled = false; $('batchGenerateBtn').textContent = 'Generate All';
    }

    // Feedback save for batch items
    function saveBatchFeedback(id, rating) {
      const it = state.items.find(x => x.id === id);
      if (!it?.draft) return;
      const feedback = JSON.parse(localStorage.getItem('agent_feedback') || '[]');
      feedback.unshift({
        id: 'fb_' + Date.now(),
        rating,
        reason: '',
        draft_preview: it.draft.slice(0,240),
        profile: __agentProfile,
        channel: it.channel || 'email',
        make: it.make, model: it.model, zip: it.zip, offersZip: it.offersZip,
        created_at: new Date().toISOString()
      });
      localStorage.setItem('agent_feedback', JSON.stringify(feedback));
      window.dispatchEvent(new Event('agent_feedback_updated'));
      alert('Feedback saved.');
    }

    // Wire buttons
    $('batchParseBtn')?.addEventListener('click', () => { state.items = parseLeads($('batchInput').value); refreshCount(); renderTable(); });
    $('batchGenerateBtn')?.addEventListener('click', generateAll);
    $('batchExportBtn')?.addEventListener('click', exportCSV);
    $('batchClearBtn')?.addEventListener('click', () => { state.items = []; $('batchInput').value=''; refreshCount(); renderTable(); });

    $('batchTableWrap')?.addEventListener('click', async (e) => {
      const btn = e.target.closest('button[data-act]');
      if (!btn) return;
      const id = btn.getAttribute('data-id');
      const act = btn.getAttribute('data-act');
      const it = state.items.find(x => x.id === id);
      if (!it) return;
      if (act === 'copy') {
        await navigator.clipboard.writeText(it.draft || '');
        alert('Draft copied.');
      } else if (act === 'fbup') {
        saveBatchFeedback(id, 'up');
      } else if (act === 'fbdown') {
        saveBatchFeedback(id, 'down');
      }
    });
  })();
  </script>

  <!-- Step 3: Run Log Viewer (localStorage today, API tomorrow) -->
  <script>
  (async function(){
    const API_BASE = ""; // later: "https://your-platform.example.com"
    async function loadRuns() {
      if (API_BASE) {
        try {
          const r = await fetch(`${API_BASE}/api/runs?limit=10`);
          if (!r.ok) throw new Error('Failed to load runs');
          return (await r.json()).runs || [];
        } catch { /* fall through to local */ }
      }
      const local = JSON.parse(localStorage.getItem('agent_runs') || '[]');
      return local.slice(0, 10);
    }

    function statusBadge(s) {
      const color = s === 'succeeded' ? '#065f46' : s === 'failed' ? '#b91c1c' : '#334155';
      return `<span style="border:1px solid ${color};color:${color};padding:2px 6px;border-radius:999px">${s}</span>`;
    }

    async function render() {
      const runs = await loadRuns();
      const el = document.getElementById('runsTable');
      if (!runs.length) { el.textContent = 'No runs yet.'; return; }
      el.innerHTML = `
        <table class="table">
          <thead><tr><th>When</th><th>Status</th><th>Channel</th><th>Profile</th><th>Preview</th><th>Actions</th></tr></thead>
          <tbody>
            ${runs.map(r => `
              <tr>
                <td>${new Date(r.created_at).toLocaleString()}</td>
                <td>${statusBadge(r.status || 'drafted')}</td>
                <td>${r.channel || '‚Äî'}</td>
                <td>${r.profile || 'new_lead'}</td>
                <td>${(r.preview || '').replace(/</g,'&lt;')}</td>
                <td>
                  <button class="btn small" data-run="${r.id}" data-action="copy">Copy ID</button>
                  <button class="btn small" data-run="${r.id}" data-action="rerun">Re-run</button>
                </td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      `;
    }

    document.getElementById('reloadRunsBtn')?.addEventListener('click', render);
    document.getElementById('runsTable')?.addEventListener('click', async (e) => {
      const btn = e.target.closest('button[data-action]');
      if (!btn) return;
      const id = btn.getAttribute('data-run');
      const action = btn.getAttribute('data-action');
      if (action === 'copy') {
        await navigator.clipboard.writeText(id);
        alert('Run ID copied.');
      } else if (action === 'rerun') {
        alert('In a real backend, this would POST /api/runs/{id}/rerun.');
      }
    });

    window.addEventListener('agent_runs_updated', render);
    window.addEventListener('agent_feedback_updated', () => { /* placeholder: could refresh a dashboard */ });
    render();
  })();
  </script>
  <!-- ==================== END SCRIPTS ==================== -->

</body>
</html>
