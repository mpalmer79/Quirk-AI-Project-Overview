<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Quirk AI — Discovery</title>

  <base href="/Quirk-AI-Project-Overview/"/>

  <link rel="stylesheet" href="assets/style.css"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    :focus-visible { outline: 2px solid #34d399; outline-offset: 2px; }
    body { background: transparent; }
    input, button {
      background:#fff !important; color:#0f172a !important; border-color:#e5e7eb !important;
    }
  </style>
</head>
<body class="min-h-[300px]">
  <div id="root"></div>

<script type="text/babel">
const { useState, useEffect } = React;

function SectionTitle({ title, subtitle }) {
  return (
    <div className="mb-4">
      <h2 className="text-xl sm:text-2xl font-bold text-emerald-800 text-center">{title}</h2>
      {subtitle && <p className="text-center text-slate-600 mt-1">{subtitle}</p>}
    </div>
  );
}
function Field({ label, children }) {
  return (
    <label className="block mb-3">
      <span className="block text-sm font-semibold text-slate-700 mb-1">{label}</span>
      {children}
    </label>
  );
}
function PrimaryButton(props){
  const cls = (props.className || "") + " px-5 py-3 rounded-2xl bg-gradient-to-r from-emerald-600 to-emerald-700 text-white font-semibold shadow hover:brightness-110 active:brightness-95";
  return <button {...props} className={cls} />;
}

function App() {
  const [budget, setBudget] = useState(400);

  // If parent sent us a starting value, load it
  useEffect(() => {
    const onMsg = (e) => {
      if (!e?.data || typeof e.data !== 'object') return;
      const { type, payload } = e.data;
      if (type === 'discovery:init' && payload?.budget != null) {
        setBudget(Number(payload.budget) || 0);
      }
    };
    window.addEventListener('message', onMsg);
    return () => window.removeEventListener('message', onMsg);
  }, []);

  function notifyUpdate(nextVal){
    window.parent?.postMessage({ type:'discovery:update', payload:{ budget: nextVal } }, '*');
  }
  function handleBack(){
    window.parent?.postMessage({ type:'discovery:back' }, '*');
  }
  function handleNext(){
    window.parent?.postMessage({ type:'discovery:done', payload:{ budget } }, '*');
  }

  return (
    <div className="p-4 sm:p-6">
      <SectionTitle title="Discovery" subtitle="Tell us your monthly target."/>
      <div className="grid sm:grid-cols-2 gap-4">
        <Field label="Budget target ($/mo)">
          <input
            type="number"
            className="w-full rounded-xl border p-3 focus:ring-2 focus:ring-emerald-300"
            value={budget}
            onChange={(e)=>{ const v = Number(e.target.value); setBudget(v); notifyUpdate(v); }}
          />
        </Field>
      </div>
      <div className="mt-4 flex justify-between">
        <button className="px-4 py-2 rounded-xl border bg-white/80" onClick={handleBack}>← Back</button>
        <PrimaryButton onClick={handleNext}>See matches →</PrimaryButton>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>
