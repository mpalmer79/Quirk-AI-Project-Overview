<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Sales Kiosk — Quirk</title>
  <meta name="description" content="Clickable demo of a kiosk-driven AI automotive retail flow." />
  <base href="/Quirk-AI-Project-Overview/">

  <!-- Tailwind (CDN) for styling to match your prototype -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React 18 + Babel for JSX-in-browser (zero-build demo) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    body { background:#f8fafc; }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- Kiosk App (converted to plain JS + JSX) -->
  <script type="text/babel">
    const { useState, useMemo } = React;

    // ---- Sample inventory (replace with live feed) ----
    const INVENTORY = [
      {
        vin: '1N4AL3AP1JC123456',
        year: 2021, make: 'Nissan', model: 'Altima SV',
        price: 19950, miles: 33210,
        photo: 'https://images.unsplash.com/photo-1549921296-3b4a841f2b36?q=80&w=1200&auto=format&fit=crop',
        features: ['Remote start', 'Safety Shield', 'CarPlay', 'Heated seats'],
      },
      {
        vin: '2FMPK3J99KBB24680',
        year: 2022, make: 'Ford', model: 'Edge SEL',
        price: 26990, miles: 24500,
        photo: 'https://images.unsplash.com/photo-1533473359331-0135ef1b58bf?q=80&w=1200&auto=format&fit=crop',
        features: ['AWD', 'Co-Pilot360', 'Power liftgate', '18" alloys'],
      },
      {
        vin: '5YJ3E1EA7KF317159',
        year: 2021, make: 'Tesla', model: 'Model 3 SR+',
        price: 28990, miles: 29800,
        photo: 'https://images.unsplash.com/photo-1511397330067-5a9327f7a131?q=80&w=1200&auto=format&fit=crop',
        features: ['Autopilot', 'Glass roof', 'Heated seats', 'Nav'],
      },
    ];

    const STEPS = [
      'Welcome','Discovery','Vehicle Match','Payments',
      'Trade-In','Credit Start','F&I Options','Review & Handoff'
    ];

    // Payment calculator — deterministic math (no AI)
    function calcPayment(amount, aprPct, termMonths) {
      const r = aprPct / 100 / 12;
      if (r === 0) return amount / termMonths;
      return (r * amount) / (1 - Math.pow(1 + r, -termMonths));
    }

    function SectionTitle({ title, subtitle }) {
      return (
        <div className="mb-4">
          <h2 className="text-xl sm:text-2xl font-bold text-emerald-800 text-center">{title}</h2>
          {subtitle && <p className="text-center text-slate-600 mt-1">{subtitle}</p>}
        </div>
      );
    }

    function Field({ label, children }) {
      return (
        <label className="block mb-3">
          <span className="block text-sm font-semibold text-slate-700 mb-1">{label}</span>
          {children}
        </label>
      );
    }

    function Welcome({ consent, setConsent, profile, setProfile, onNext }) {
      return (
        <div>
          <SectionTitle title="Welcome to Quirk" subtitle="I’ll match you to the right vehicle and payment in minutes." />
          <div className="grid sm:grid-cols-2 gap-4">
            <Field label="Your name (optional)">
              <input aria-label="Your name" className="w-full rounded-xl border p-3" value={profile.name} onChange={e => setProfile({ ...profile, name: e.target.value })} />
            </Field>
            <Field label="Text or email to send your quote (optional)">
              <input aria-label="Contact" className="w-full rounded-xl border p-3" placeholder="(555) 555-5555 or you@example.com" value={profile.contact} onChange={e => setProfile({ ...profile, contact: e.target.value })} />
            </Field>
          </div>

          <details className="mt-2">
            <summary className="cursor-pointer text-slate-600">Consent & privacy</summary>
            <div className="grid sm:grid-cols-3 gap-3 mt-2">
              <label className="flex items-center gap-2"><input type="checkbox" checked={consent.sms} onChange={e => setConsent({ ...consent, sms: e.target.checked })} /> SMS updates</label>
              <label className="flex items-center gap-2"><input type="checkbox" checked={consent.email} onChange={e => setConsent({ ...consent, email: e.target.checked })} /> Email updates</label>
              <label className="flex items-center gap-2"><input type="checkbox" checked={consent.privacy} onChange={e => setConsent({ ...consent, privacy: e.target.checked })} /> I agree to privacy policy</label>
            </div>
          </details>

          <div className="mt-4 flex justify-end">
            <button className="px-5 py-3 rounded-2xl bg-emerald-600 text-white font-semibold" onClick={onNext} aria-label="Start">Start →</button>
          </div>
        </div>
      );
    }

    function Discovery({ profile, setProfile, onNext, onBack }) {
      return (
        <div>
          <SectionTitle title="Tell us what you need" subtitle="A few quick choices so we can tailor the match." />
          <div className="grid sm:grid-cols-2 gap-4">
            <Field label="Primary use">
              <select className="w-full rounded-xl border p-3" value={profile.useCase} onChange={e => setProfile({ ...profile, useCase: e.target.value })}>
                {['Commute', 'Family', 'Adventure', 'Business'].map(x => <option key={x}>{x}</option>)}
              </select>
            </Field>
            <Field label="Preferred body style">
              <select className="w-full rounded-xl border p-3" value={profile.bodyStyle} onChange={e => setProfile({ ...profile, bodyStyle: e.target.value })}>
                {['Sedan', 'SUV', 'Truck', 'EV'].map(x => <option key={x}>{x}</option>)}
              </select>
            </Field>
            <Field label="Monthly budget target">
              <input type="number" className="w-full rounded-xl border p-3" value={profile.budget} onChange={e => setProfile({ ...profile, budget: Number(e.target.value) })} />
            </Field>
            <Field label="Timeline">
              <select className="w-full rounded-xl border p-3" value={profile.timeline} onChange={e => setProfile({ ...profile, timeline: e.target.value })}>
                {['Today', 'This week', 'This month', 'Just researching'].map(x => <option key={x}>{x}</option>)}
              </select>
            </Field>
          </div>
          <div className="mt-4 flex justify-between">
            <button className="px-4 py-2 rounded-xl border" onClick={onBack}>← Back</button>
            <button className="px-5 py-3 rounded-2xl bg-emerald-600 text-white font-semibold" onClick={onNext}>See matches →</button>
          </div>
        </div>
      );
    }

    function VehicleMatch({ selectedVin, onSelect, onBack }) {
      return (
        <div>
          <SectionTitle title="Best matches" subtitle="Tap a vehicle to continue." />
          <div className="grid md:grid-cols-3 gap-4">
            {INVENTORY.map(v => (
              <button key={v.vin} className={`text-left rounded-2xl border shadow-sm hover:shadow-md transition p-3 ${selectedVin === v.vin ? 'ring-4 ring-emerald-300' : ''}`} onClick={() => onSelect(v.vin)}>
                <img src={v.photo} alt={`${v.make} ${v.model}`} className="w-full h-40 object-cover rounded-xl" />
                <div className="mt-2 font-semibold">{v.year} {v.make} {v.model}</div>
                <div className="text-emerald-700 font-bold">${v.price.toLocaleString()}</div>
                <div className="text-sm text-slate-600">{v.miles.toLocaleString()} miles</div>
                <details className="mt-1">
                  <summary className="text-sm text-slate-500">Open for more</summary>
                  <ul className="list-disc ml-5 text-sm mt-1">
                    {v.features.map(f => <li key={f}>{f}</li>)}
                  </ul>
                </details>
              </button>
            ))}
          </div>
          <div className="mt-4 flex justify-between">
            <button className="px-4 py-2 rounded-xl border" onClick={onBack}>← Back</button>
            <span className="text-sm text-slate-500">Choose a vehicle to continue</span>
          </div>
        </div>
      );
    }

    function Payments({ vehicle, desk, setDesk, monthly, amountFinanced, onBack, onNext }) {
      const price = vehicle ? vehicle.price : desk.price;
      return (
        <div>
          <SectionTitle title="Build your payment" subtitle="Deterministic calculator; real taxes/fees plug in here." />
          <div className="grid md:grid-cols-2 gap-6">
            <div>
              <div className="rounded-xl border p-4">
                <div className="text-sm text-slate-600 mb-2">Vehicle price</div>
                <div className="text-2xl font-bold">${price.toLocaleString()}</div>
                <div className="grid grid-cols-2 gap-3 mt-4">
                  <Field label="Down payment">
                    <input type="number" className="w-full rounded-xl border p-3" value={desk.down} onChange={e => setDesk({ ...desk, down: Number(e.target.value) })} />
                  </Field>
                  <Field label="Taxes & fees (est.)">
                    <input type="number" className="w-full rounded-xl border p-3" value={desk.taxesFees} onChange={e => setDesk({ ...desk, taxesFees: Number(e.target.value) })} />
                  </Field>
                  <Field label="APR %">
                    <input type="number" className="w-full rounded-xl border p-3" value={desk.apr} step={0.1} onChange={e => setDesk({ ...desk, apr: Number(e.target.value) })} />
                  </Field>
                  <Field label="Term (months)">
                    <select className="w-full rounded-xl border p-3" value={desk.term} onChange={e => setDesk({ ...desk, term: Number(e.target.value) })}>
                      {[36, 48, 60, 72, 84].map(n => <option key={n} value={n}>{n}</option>)}
                    </select>
                  </Field>
                </div>
                <details className="mt-2">
                  <summary className="text-slate-600 cursor-pointer">Products</summary>
                  <div className="grid sm:grid-cols-3 gap-3 mt-2">
                    <label className="flex items-center gap-2"><input type="checkbox" checked={desk.products.vsc} onChange={e => setDesk({ ...desk, products: { ...desk.products, vsc: e.target.checked } })} /> VSC ($1,895)</label>
                    <label className="flex items-center gap-2"><input type="checkbox" checked={desk.products.gap} onChange={e => setDesk({ ...desk, products: { ...desk.products, gap: e.target.checked } })} /> GAP ($795)</label>
                    <label className="flex items-center gap-2"><input type="checkbox" checked={desk.products.maint} onChange={e => setDesk({ ...desk, products: { ...desk.products, maint: e.target.checked } })} /> Maintenance ($495)</label>
                  </div>
                </details>
              </div>
            </div>
            <div className="rounded-2xl border p-4 bg-emerald-50">
              <div className="text-sm text-emerald-700">Estimated monthly</div>
              <div className="text-4xl font-extrabold text-emerald-800">${monthly.toFixed(0)}</div>
              <div className="text-sm text-slate-600 mt-2">Amount financed: ${amountFinanced.toLocaleString()}</div>
              <p className="text-xs text-slate-500 mt-2">Estimates only; subject to lender approval, credit tier, LTV, and program rules. Your final payment may vary.</p>
            </div>
          </div>
          <div className="mt-4 flex justify-between">
            <button className="px-4 py-2 rounded-xl border" onClick={onBack}>← Back</button>
            <button className="px-5 py-3 rounded-2xl bg-emerald-600 text-white font-semibold" onClick={onNext}>Add trade →</button>
          </div>
        </div>
      );
    }

    function Trade({ trade, setTrade, estimate, onBack, onNext }) {
      return (
        <div>
          <SectionTitle title="Trade-in pre-valuation" subtitle="Get a market-based range. Final number after in-person inspection." />
          <div className="grid md:grid-cols-3 gap-4">
            <Field label="VIN">
              <input className="w-full rounded-xl border p-3" value={trade.vin} onChange={e => setTrade({ ...trade, vin: e.target.value })} placeholder="Scan or type VIN" />
            </Field>
            <Field label="Mileage">
              <input className="w-full rounded-xl border p-3" value={trade.miles} onChange={e => setTrade({ ...trade, miles: e.target.value })} placeholder="e.g., 45,500" />
            </Field>
            <Field label="Condition">
              <select className="w-full rounded-xl border p-3" value={trade.condition} onChange={e => setTrade({ ...trade, condition: e.target.value })}>
                {['Great', 'Average', 'Rough'].map(x => <option key={x}>{x}</option>)}
              </select>
            </Field>
          </div>
          <div className="mt-2 flex gap-2">
            <button className="px-4 py-2 rounded-xl border" onClick={estimate}>Estimate range</button>
            {trade.rangeLow > 0 && (
              <div className="px-4 py-2 rounded-xl bg-emerald-50 border border-emerald-200 text-emerald-800">
                Estimated range: ${trade.rangeLow.toLocaleString()} – ${trade.rangeHigh.toLocaleString()}
              </div>
            )}
          </div>
          <div className="mt-4 flex justify-between">
            <button className="px-4 py-2 rounded-xl border" onClick={onBack}>← Back</button>
            <button className="px-5 py-3 rounded-2xl bg-emerald-600 text-white font-semibold" onClick={onNext}>Start credit →</button>
          </div>
        </div>
      );
    }

    function CreditStart({ onBack, onNext }) {
      return (
        <div>
          <SectionTitle title="Start your credit application" subtitle="Soft pull first. No impact to score until you consent to submit." />
          <div className="grid md:grid-cols-3 gap-4">
            <Field label="Full name"><input className="w-full rounded-xl border p-3" /></Field>
            <Field label="Email"><input className="w-full rounded-xl border p-3" /></Field>
            <Field label="Mobile"><input className="w-full rounded-xl border p-3" /></Field>
            <Field label="ZIP"><input className="w-full rounded-xl border p-3" /></Field>
            <Field label="Income (monthly)"><input className="w-full rounded-xl border p-3" /></Field>
            <Field label="Consent to soft pull">
              <label className="flex items-center gap-2"><input type="checkbox" /> I agree to a soft inquiry</label>
            </Field>
          </div>
          <div className="mt-4 flex justify-between">
            <button className="px-4 py-2 rounded-xl border" onClick={onBack}>← Back</button>
            <button className="px-5 py-3 rounded-2xl bg-emerald-600 text-white font-semibold" onClick={onNext}>Preview protection →</button>
          </div>
        </div>
      );
    }

    function FandI({ desk, setDesk, monthly, onBack, onNext }) {
      return (
        <div>
          <SectionTitle title="Protect your purchase" subtitle="Add options and see the impact instantly." />
          <div className="grid sm:grid-cols-3 gap-4">
            <label className="rounded-2xl border p-4 flex items-start gap-3">
              <input type="checkbox" checked={desk.products.vsc} onChange={e => setDesk({ ...desk, products: { ...desk.products, vsc: e.target.checked } })} />
              <div>
                <div className="font-semibold">Vehicle Service Contract</div>
                <div className="text-sm text-slate-600">Covers major repairs beyond factory warranty. +$1,895</div>
              </div>
            </label>
            <label className="rounded-2xl border p-4 flex items-start gap-3">
              <input type="checkbox" checked={desk.products.gap} onChange={e => setDesk({ ...desk, products: { ...desk.products, gap: e.target.checked } })} />
              <div>
                <div className="font-semibold">GAP</div>
                <div className="text-sm text-slate-600">Protects against total loss payoff gap. +$795</div>
              </div>
            </label>
            <label className="rounded-2xl border p-4 flex items-start gap-3">
              <input type="checkbox" checked={desk.products.maint} onChange={e => setDesk({ ...desk, products: { ...desk.products, maint: e.target.checked } })} />
              <div>
                <div className="font-semibold">Maintenance</div>
                <div className="text-sm text-slate-600">Prepaid maintenance services. +$495</div>
              </div>
            </label>
          </div>
          <div className="mt-3 p-3 rounded-xl bg-emerald-50 border border-emerald-200 text-emerald-800">
            Current estimated payment: <strong>${monthly.toFixed(0)}</strong>
          </div>
          <div className="mt-4 flex justify-between">
            <button className="px-4 py-2 rounded-xl border" onClick={onBack}>← Back</button>
            <button className="px-5 py-3 rounded-2xl bg-emerald-600 text-white font-semibold" onClick={onNext}>Review & handoff →</button>
          </div>
        </div>
      );
    }

    function Review({ profile, vehicle, desk, trade, monthly, onBack }) {
      return (
        <div>
          <SectionTitle title="Review & handoff" subtitle="We’ll prep your buyer’s order and connect you to a manager or F&I." />
          <div className="grid md:grid-cols-2 gap-4">
            <div className="rounded-2xl border p-4">
              <div className="font-semibold mb-2">Your picks</div>
              <ul className="text-sm text-slate-700 space-y-1">
                <li><strong>Name:</strong> {profile.name || '—'}</li>
                <li><strong>Contact:</strong> {profile.contact || '—'}</li>
                <li><strong>Use:</strong> {profile.useCase} • <strong>Body style:</strong> {profile.bodyStyle}</li>
                <li><strong>Budget target:</strong> ${profile.budget}/mo</li>
                <li><strong>Vehicle:</strong> {vehicle ? `${vehicle.year} ${vehicle.make} ${vehicle.model}` : '—'}</li>
                <li><strong>Trade range:</strong> {trade.rangeLow ? `$${trade.rangeLow.toLocaleString()}–$${trade.rangeHigh.toLocaleString()}` : '—'}</li>
              </ul>
            </div>
            <div className="rounded-2xl border p-4">
              <div className="font-semibold mb-2">Deal preview</div>
              <ul className="text-sm text-slate-700 space-y-1">
                <li><strong>Est. monthly:</strong> ${monthly.toFixed(0)}</li>
                <li><strong>Down:</strong> ${Number(desk.down).toLocaleString()}</li>
                <li><strong>APR/Term:</strong> {desk.apr}% • {desk.term} mos</li>
                <li><strong>Taxes & fees:</strong> ${desk.taxesFees.toLocaleString()}</li>
                <li><strong>Products:</strong> {(desk.products.vsc ? 'VSC ' : '') + (desk.products.gap ? 'GAP ' : '') + (desk.products.maint ? 'Maint' : '') || '—'}</li>
              </ul>
              <p className="text-xs text-slate-500 mt-2">This is a draft for review, not a binding offer. Final numbers subject to inspection and lender approval.</p>
            </div>
          </div>
          <div className="mt-4 flex flex-wrap gap-3 justify-between">
            <button className="px-4 py-2 rounded-xl border" onClick={onBack}>← Back</button>
            <div className="flex gap-2">
              <button className="px-4 py-2 rounded-xl border bg-white">Raise hand for manager</button>
              <button className="px-4 py-2 rounded-2xl bg-emerald-600 text-white font-semibold">Text me this summary</button>
              <button className="px-4 py-2 rounded-2xl bg-emerald-700 text-white font-semibold">I’m ready now</button>
            </div>
          </div>
        </div>
      );
    }

    function KioskFlowDemo() {
      const [step, setStep] = useState(0);
      const [consent, setConsent] = useState({ sms: false, email: false, privacy: false });
      const [profile, setProfile] = useState({ name: '', contact: '', useCase: 'Commute', bodyStyle: 'Sedan', budget: 400, timeline: 'This week' });
      const [selectedVin, setSelectedVin] = useState(null);
      const [desk, setDesk] = useState({ price: 0, down: 2000, apr: 6.9, term: 72, taxesFees: 995, products: { vsc: false, gap: false, maint: false } });
      const [trade, setTrade] = useState({ vin: '', miles: '', condition: 'Average', rangeLow: 0, rangeHigh: 0 });

      const vehicle = useMemo(() => INVENTORY.find(v => v.vin === selectedVin) || null, [selectedVin]);
      const productTotal = useMemo(() => (desk.products.vsc?1895:0)+(desk.products.gap?795:0)+(desk.products.maint?495:0), [desk.products]);
      const mid = (n) => (isFinite(n) && !isNaN(n) ? n : 0);
      const amountFinanced = useMemo(() => {
        const price = vehicle ? vehicle.price : desk.price;
        const gross = price + desk.taxesFees + productTotal - Number(desk.down || 0) - mid((trade.rangeLow + trade.rangeHigh) / 2);
        return Math.max(gross, 0);
      }, [vehicle, desk.down, desk.taxesFees, productTotal, trade.rangeLow, trade.rangeHigh]);
      const monthly = useMemo(() => calcPayment(amountFinanced, desk.apr, desk.term), [amountFinanced, desk.apr, desk.term]);

      function next(){ setStep(s => Math.min(s+1, STEPS.length-1)); }
      function back(){ setStep(s => Math.max(s-1, 0)); }
      function estimateTradeRange(){
        const base = 12000;
        const miles = parseInt(trade.miles || '0', 10);
        const adjMiles = Math.max(0, (60000 - miles) * 0.05);
        const cond = trade.condition === 'Great' ? 1500 : (trade.condition === 'Rough' ? -1500 : 0);
        const low = Math.max(500, base + adjMiles + cond - 1500);
        const high = Math.max(low + 500, base + adjMiles + cond + 1500);
        setTrade(t => ({ ...t, rangeLow: Math.round(low), rangeHigh: Math.round(high) }));
      }
      function selectVehicle(vin){
        const v = INVENTORY.find(x => x.vin === vin);
        if (v){ setSelectedVin(v.vin); setDesk(d => ({...d, price: v.price })); next(); }
      }

      return (
        <div className="w-full min-h-screen bg-slate-50 p-4 sm:p-8">
          <div className="max-w-6xl mx-auto">
            <header className="flex items-center justify-between mb-4">
              <h1 className="text-2xl font-extrabold tracking-tight text-emerald-800">AI Sales Kiosk</h1>
              <div className="text-sm text-slate-500">{STEPS[step]}</div>
            </header>

            <ol className="grid grid-cols-4 sm:grid-cols-8 gap-2 mb-6" aria-label="Progress">
              {STEPS.map((label, i) => (
                <li key={label} className={`h-2 rounded-full ${i <= step ? 'bg-emerald-600' : 'bg-slate-300'}`} aria-label={label} />
              ))}
            </ol>

            <div className="bg-white rounded-2xl shadow-xl border border-slate-200 p-4 sm:p-6">
              {step===0 && <Welcome consent={consent} setConsent={setConsent} profile={profile} setProfile={setProfile} onNext={next} />}
              {step===1 && <Discovery profile={profile} setProfile={setProfile} onNext={next} onBack={back} />}
              {step===2 && <VehicleMatch selectedVin={selectedVin} onSelect={selectVehicle} onBack={back} />}
              {step===3 && <Payments vehicle={vehicle} desk={desk} setDesk={setDesk} monthly={monthly} amountFinanced={amountFinanced} onBack={back} onNext={next} />}
              {step===4 && <Trade trade={trade} setTrade={setTrade} estimate={estimateTradeRange} onBack={back} onNext={next} />}
              {step===5 && <CreditStart onBack={back} onNext={next} />}
              {step===6 && <FandI desk={desk} setDesk={setDesk} monthly={monthly} onBack={back} onNext={next} />}
              {step===7 && <Review profile={profile} vehicle={vehicle} desk={desk} trade={trade} monthly={monthly} onBack={back} />}
            </div>

            <div className="flex justify-between items-center mt-4">
              <button className="px-4 py-2 rounded-xl border border-slate-300 text-slate-700" onClick={back} disabled={step===0}>← Back</button>
              <details className="text-sm">
                <summary className="cursor-pointer text-slate-500">Open for more</summary>
                <div className="mt-2 max-w-3xl text-slate-600">
                  <p className="mb-2"><strong>Integration stubs:</strong> VIN Solutions (lead + appointment), payment API, RouteOne/Dealertrack soft pull, Accu-Trade/KBB trade, Darwin/MenuSys for F&I. Replace placeholders and enforce audit logging.</p>
                  <p className="text-xs">Compliance: deterministic calculators; disclose taxes/fees/incentives; collect consent (GLBA/FTC/TCPA). Demo only.</p>
                </div>
              </details>
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<KioskFlowDemo />);
  </script>
</body>
</html>
